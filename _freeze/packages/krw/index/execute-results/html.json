{
  "hash": "c2ad56ea3ede25873215c403711d7684",
  "result": {
    "markdown": "---\ntitle: \"krw\"\n#author: \"Johan van Tent\"\n#date: \"2022-10-01\"\ncategories: [R-packages]\ndescription: \"Het doel van het package **krw** is om KRW-toetsingen uit te kunnen voeren in R.\"\n---\n\n\n\n# Package krw\n\nHet doel van het package **krw** is om KRW-toetsingen uit te kunnen voeren in R. Het package is te installeren vanaf [GitHub](https://github.com/) met:\n\n``` r\n# install.packages(\"devtools\")\ndevtools::install_github(\"RedTent/krw\")\n```\n\nHet package krw wordt momenteel net actief ontwikkeld. Op dit moment zijn de volgende soortgroepen geimplementeerd.\n\n\n- Macrofauna \n    - *m.u.v R8 en K- en O-typen*\n- Macrofyten\n    - Soortensamenstelling\n\n\n\n\n## Macrofauna\n\nDit is een simpel voorbeeld van de KRW-toetsing van macrofauna.\n\nEerst maken we twee eenvoudige datasets.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(krw)\n\ndataset1 <- \n  tibble::tribble(\n    ~meetpunt, ~krwwatertype.code,              ~taxon, ~aantal,\n          \"A\",              \"M27\", \"Asellus aquaticus\",     100,\n          \"A\",              \"M27\",      \"Baetis niger\",      20,\n          \"A\",              \"M27\",    \"Caenis horaria\",      40,\n    )\n\ndataset2 <- \n  tibble::tribble(\n     ~meetpunt, ~jaar, ~krwwatertype.code,              ~taxon, ~aantal,\n           \"A\",  2018,              \"M1a\", \"Asellus aquaticus\",     100,\n           \"A\",  2018,              \"M1a\",      \"Baetis niger\",      20,\n           \"B\",  2018,               \"R6\", \"Asellus aquaticus\",     100,\n           \"B\",  2018,               \"R6\",      \"Baetis niger\",      20,\n           \"B\",  2019,               \"R6\", \"Asellus aquaticus\",     150,\n           \"B\",  2019,               \"R6\",      \"Baetis niger\",      35\n     )\n\n```\n:::\n\n\n### Toetsing van een enkel monster\n\nDe toetsing van een enkel monster kan eenvoudig worden uitgevoerd met de functie `krw_mafa_ekr()`. De omrekening van aantallen naar abundanties wordt automatisch door de functie gedaan.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n\nkrw_mafa_ekr(dataset1, \n             biotaxon.naam = taxon, \n             krwwatertype.code = krwwatertype.code, \n             waarde = aantal,\n             verbose = FALSE)\n#> # A tibble: 1 × 2\n#>   krwwatertype.code ekr_mafa\n#>   <chr>                <dbl>\n#> 1 M27                  0.233\n\n# Alternatieve notatie\n# \n# krw:::krw_mafa_ekr(dataset1, \n#                    biotaxon.naam = \"taxon\", \n#                    krwwatertype.code = \"krwwatertype.code\", \n#                    waarde = \"aantal\")\n# \n# Meer detail informatie kan worden verkregen met de optie `verbose = TRUE`\n```\n:::\n\n\n### Toetsing van meerdere monsters\n\nMeerdere monsters kunnen met tegelijk met dezelfde functie worden getoetst. Het is hiervoor wel noodzakelijk dat het dataframe met de dataset wordt gegroepeerd per monster met de functie `group_by` uit de package `dplyr`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\ndataset2 %>% \n  dplyr::group_by(meetpunt, jaar) %>% \n  krw_mafa_ekr(biotaxon.naam = taxon, \n               krwwatertype.code = krwwatertype.code, \n               waarde = aantal)\n#> # A tibble: 3 × 4\n#>   meetpunt  jaar krwwatertype.code ekr_mafa\n#>   <chr>    <dbl> <chr>                <dbl>\n#> 1 A         2018 M1a                  0    \n#> 2 B         2018 R6                   0.64 \n#> 3 B         2019 R6                   0.673\n```\n:::\n\n\n## Macrofyten - soortensamenstelling\n\nDe toetsing voor de macrofytensoortensamenstelling is zeer vergelijkbaar met de macrofaunatoetsing. Het is mogelijk om meerdere monsters tegelijk te toetsen door met de functie `dplyr::group_by` van elk monster een groep te maken.\n\nEerst maken we weer een testdata set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmafy_data <- tibble::tribble(\n    ~mp, ~jaar, ~watertype,             ~taxon,     ~waarde,\n    \"A\",  2018,      \"M27\",   \"Acorus calamus\",           1,\n    \"A\",  2018,      \"M27\",    \"Berula erecta\",           1,\n    \"A\",  2018,      \"M27\",   \"Chara vulgaris\",          10,\n    \"A\",  2018,      \"M27\", \"Elodea nuttallii\",          30,\n    \"A\",  2019,      \"M27\",   \"Acorus calamus\",           1,\n    \"A\",  2019,      \"M27\",    \"Berula erecta\",           1,\n    \"A\",  2019,      \"M27\",   \"Chara vulgaris\",          30,\n    \"A\",  2019,      \"M27\", \"Elodea nuttallii\",          10,\n    \"B\",  2018,      \"M10\",   \"Acorus calamus\",           1,\n    \"B\",  2018,      \"M10\",    \"Berula erecta\",           1,\n    \"B\",  2018,      \"M10\",   \"Chara vulgaris\",          10,\n    \"B\",  2018,      \"M10\", \"Elodea nuttallii\",          30,\n    \"B\",  2019,      \"M10\",   \"Acorus calamus\",           1,\n    \"B\",  2019,      \"M10\",    \"Berula erecta\",           1,\n    \"B\",  2019,      \"M10\",   \"Chara vulgaris\",          30,\n    \"B\",  2019,      \"M10\", \"Elodea nuttallii\",          10\n)\n```\n:::\n\n\nVoor macrofyten moet de bedekking eerst omgerekend worden naar een abundantieklasse. Voor de macrofyten gebeurt dit met de functie `add_abundantieklasse()`. Deze functie rekent zowel percentages (`type = \"percentage\"`) als klassen (1 t/m 9 `type = \"klasse\"`) om.\n\nVoor de kunstmatige wateren worden ook de onderliggende EKR's voor hydrofyten en helofyten weergegeven.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\nmafy_met_abundantie <- mafy_data %>% \n  add_abundantieklasse(bedekking = waarde, type = \"percentage\")\nhead(mafy_met_abundantie)\n#> # A tibble: 6 × 6\n#>   mp     jaar watertype taxon            waarde abundantieklasse\n#>   <chr> <dbl> <chr>     <chr>             <dbl>            <int>\n#> 1 A      2018 M27       Acorus calamus        1                1\n#> 2 A      2018 M27       Berula erecta         1                1\n#> 3 A      2018 M27       Chara vulgaris       10                2\n#> 4 A      2018 M27       Elodea nuttallii     30                2\n#> 5 A      2019 M27       Acorus calamus        1                1\n#> 6 A      2019 M27       Berula erecta         1                1\n\nmafy_met_abundantie %>% \n  dplyr::group_by(mp, jaar) %>% \n  krw_mafy_ekr_ss(krwwatertype.code = watertype, \n                  biotaxon.naam = taxon, \n                  abundantieklasse = abundantieklasse,\n                  verbose = FALSE)\n#> # A tibble: 4 × 6\n#>   mp     jaar krwwatertype.code ekr_ss_mafy ekr_ss_hydro ekr_ss_helo\n#>   <chr> <dbl> <chr>                   <dbl>        <dbl>       <dbl>\n#> 1 A      2018 M27                     0.420       NA              NA\n#> 2 A      2019 M27                     0.420       NA              NA\n#> 3 B      2018 M10                     0.444        0.666           0\n#> 4 B      2019 M10                     0.444        0.666           0\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}